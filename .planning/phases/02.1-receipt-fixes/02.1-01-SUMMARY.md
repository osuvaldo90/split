---
phase: 02.1-receipt-fixes
plan: 01
subsystem: ui
tags: [convex, react, forms, ux]

# Dependency graph
requires:
  - phase: 02-receipt-processing
    provides: Receipt OCR parsing and review flow
provides:
  - Receipt replace behavior (new uploads clear existing items)
  - Consistent money formatting ($X.XX) in all inputs
affects: [03-claiming, 06-calculation]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - addBulk mutation now handles replace semantics (delete-then-insert)
    - toFixed(2) for consistent money display in inputs

key-files:
  created: []
  modified:
    - convex/items.ts
    - src/pages/Session.tsx
    - src/components/ItemEditor.tsx
    - src/components/ReceiptReview.tsx

key-decisions:
  - "Replace semantics in addBulk mutation rather than separate delete+add calls"

patterns-established:
  - "toFixed(2) for all money input values to ensure $X.XX display"

issues-created: []

# Metrics
duration: 1 min
completed: 2026-01-14
---

# Phase 2.1 Plan 01: Receipt Fixes Summary

**Receipt replace behavior and consistent $X.XX money formatting across all input fields**

## Performance

- **Duration:** 1 min
- **Started:** 2026-01-14T20:14:25Z
- **Completed:** 2026-01-14T20:15:36Z
- **Tasks:** 2
- **Files modified:** 4

## Accomplishments

- New receipt uploads now replace existing items instead of appending
- All money inputs display with 2 decimal places ($4.80 not $4.8)
- Simplified Session.tsx by removing redundant "Replace Receipt" button

## Task Commits

Each task was committed atomically:

1. **Task 1: Implement receipt replace behavior** - `5d319da` (feat)
2. **Task 2: Format money inputs consistently** - `104a95a` (feat)

## Files Created/Modified

- `convex/items.ts` - Modified addBulk to delete existing items/claims before inserting new ones
- `src/pages/Session.tsx` - Simplified receipt upload UI, removed redundant button
- `src/components/ItemEditor.tsx` - Price input now uses toFixed(2) for display
- `src/components/ReceiptReview.tsx` - Subtotal and tax inputs now use toFixed(2) for display

## Decisions Made

- **Replace semantics in addBulk**: Rather than creating a separate "replaceItems" mutation, modified the existing addBulk to handle replace behavior. This simplifies the API since the review flow always intends to replace, not append.

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## Next Phase Readiness

- Receipt fixes complete for plan 01
- Ready for plan 02 (split quantity items into separate lines)

---
*Phase: 02.1-receipt-fixes*
*Completed: 2026-01-14*
