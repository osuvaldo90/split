---
phase: 08-polish-optimization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [src/components/ClaimableItem.tsx]
autonomous: true
---

<objective>
Polish item interactions: fix edit mode overflow, add update animations, add auto-decimal for price.

Purpose: Make item interactions feel responsive and polished with visual feedback and better input handling.
Output: Refined ClaimableItem component with animations, fixed layout, and price formatting.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-polish-optimization/08-CONTEXT.md

@src/components/ClaimableItem.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix edit mode layout overflow</name>
  <files>src/components/ClaimableItem.tsx</files>
  <action>
    The edit mode layout (lines 152-233) currently overflows on desktop. Fix with a cleaner stacked layout that works consistently on both mobile and desktop:

    1. Change edit mode layout to always stack vertically:
       - Row 1: Name input (full width)
       - Row 2: Price input with $ prefix + Quantity input (if qty > 1) + Delete button
       - Row 3: Cancel + Save buttons

    2. Constrain all inputs to fit within container:
       - Remove sm:flex-row from outer container - always use flex-col
       - Each row uses flex with gap-2
       - Price input: w-24 (remove sm:w-24, just w-24)
       - Buttons: use flex-1 on mobile to split evenly, fixed width unnecessary

    3. Remove sm: responsive breakpoints from edit mode - use same layout always.

    4. Ensure buttons don't overflow:
       - Use min-w-0 on flex children if needed to prevent overflow
       - Cancel/Save row: both buttons flex-1 to share space evenly
  </action>
  <verify>npm run build succeeds, edit mode fits within container on both mobile and desktop</verify>
  <done>Edit mode layout contained, no horizontal overflow on any screen size</done>
</task>

<task type="auto">
  <name>Task 2: Add item update flash animation</name>
  <files>src/components/ClaimableItem.tsx</files>
  <action>
    Add visual feedback when item data changes (name or price updated by any participant):

    1. Add state to track flash: `const [isFlashing, setIsFlashing] = useState(false)`

    2. Add useEffect to detect item changes and trigger flash:
       ```tsx
       const prevItemRef = useRef({ name: item.name, price: item.price });

       useEffect(() => {
         if (
           prevItemRef.current.name !== item.name ||
           prevItemRef.current.price !== item.price
         ) {
           setIsFlashing(true);
           const timer = setTimeout(() => setIsFlashing(false), 500);
           prevItemRef.current = { name: item.name, price: item.price };
           return () => clearTimeout(timer);
         }
       }, [item.name, item.price]);
       ```

    3. Add flash styling to view mode container (the main div):
       - Add transition-colors class
       - When isFlashing, add `ring-2 ring-blue-400 ring-opacity-75` temporarily
       - Uses ring instead of background to not conflict with existing bg colors

    4. Keep animation subtle - 500ms duration, quick visual acknowledgment.
  </action>
  <verify>npm run build succeeds</verify>
  <done>Items flash briefly when name or price changes</done>
</task>

<task type="auto">
  <name>Task 3: Add auto-decimal for price input</name>
  <files>src/components/ClaimableItem.tsx</files>
  <action>
    Auto-format price on blur to always have 2 decimal places:

    1. Add onBlur handler to price input:
       ```tsx
       onBlur={(e) => {
         const value = parseFloat(e.target.value);
         if (!isNaN(value)) {
           setEditPriceInput(value.toFixed(2));
         }
       }}
       ```

    2. This ensures "$5" becomes "$5.00" and "$5.5" becomes "$5.50" on blur
       - Input remains flexible during typing (user can type "5" then "45" for $5.45)

    3. Keep the existing inputMode="decimal" for proper mobile keyboard.
  </action>
  <verify>npm run build succeeds</verify>
  <done>Price auto-formats to 2 decimals on blur</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] Edit mode layout fits within container (no horizontal scroll)
- [ ] Items flash briefly when updated
- [ ] Price formats to 2 decimal places on blur
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Item interactions feel polished and responsive
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-optimization/08-02-SUMMARY.md`
</output>
