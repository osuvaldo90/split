---
phase: 08-polish-optimization
plan: 03
type: execute
wave: 2
depends_on: ["08-01", "08-02"]
files_modified: [src/pages/Session.tsx, src/components/JoinSession.tsx, convex/sessions.ts, convex/participants.ts]
autonomous: false
---

<objective>
Add user-friendly error messages and verify all polish changes visually.

Purpose: Make error states helpful rather than confusing, and ensure all UX polish changes work correctly together.
Output: User-friendly error handling and verified polish implementation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-polish-optimization/08-CONTEXT.md
@.planning/phases/08-polish-optimization/08-01-SUMMARY.md
@.planning/phases/08-polish-optimization/08-02-SUMMARY.md

@src/components/JoinSession.tsx
@convex/sessions.ts
@convex/participants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Improve error messages for join flow</name>
  <files>src/components/JoinSession.tsx, convex/participants.ts</files>
  <action>
    Make join session errors user-friendly:

    1. In convex/participants.ts join mutation:
       - Check if the mutation throws for duplicate names
       - If it does, ensure the error message is descriptive: "That name is already taken. Please choose a different name."
       - If session doesn't exist: "Session not found. Please check the code and try again."

    2. In JoinSession.tsx:
       - Catch mutation errors and display them in the UI
       - Add error state: `const [error, setError] = useState<string | null>(null)`
       - On mutation error, extract message and show below the form:
         ```tsx
         {error && (
           <p className="text-sm text-red-600 mt-2">{error}</p>
         )}
         ```
       - Clear error when user starts typing again
       - Parse Convex errors - they come as `ConvexError` with message property, or generic Error

    3. Keep error messages short and actionable - tell user what to do.
  </action>
  <verify>npm run build succeeds</verify>
  <done>Join flow shows friendly error messages for common issues</done>
</task>

<task type="auto">
  <name>Task 2: Improve error messages for session not found</name>
  <files>src/pages/Session.tsx</files>
  <action>
    Make the "session not found" error more helpful:

    1. Update the session not found UI (lines 227-235):
       - Change from red error styling to neutral/informative
       - Add helpful message: "This bill might have expired or the code might be wrong."
       - Add a "Go Home" button that navigates to "/" to start fresh
       - Use Link from react-router-dom for navigation

    2. Example structure:
       ```tsx
       <div className="p-4 text-center">
         <h1 className="text-xl font-semibold text-gray-900 mb-2">Bill Not Found</h1>
         <p className="text-gray-600 mb-4">
           Code "{code}" doesn't match any active bill.
           It might have expired or there's a typo.
         </p>
         <Link to="/" className="text-blue-500 hover:text-blue-600 font-medium">
           ‚Üê Start a new bill
         </Link>
       </div>
       ```

    3. Use "Bill" instead of "Session" in user-facing text (more natural language).
  </action>
  <verify>npm run build succeeds</verify>
  <done>Session not found page is helpful and provides clear next steps</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 8 polish: layout restructure, item animations, input improvements, error handling</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Open: http://localhost:3000

    **Test header changes (from 08-01):**
    3. Create a new session - verify "Split" header is gone
    4. Session code should be prominent in header area
    5. Tap session code - should copy to clipboard and show toast

    **Test scroll behavior (from 08-01):**
    6. Upload a receipt with several items
    7. Scroll the page - should be one continuous scroll (no nested scroll areas)
    8. Who's Here, Receipt, Items should all scroll together

    **Test item styling (from 08-01 + 08-02):**
    9. Check item spacing is tighter (more visible per screen)
    10. Click edit on an item - edit form should fit within container (no overflow)
    11. Type a price like "5" and blur - should format to "5.00"

    **Test item animations (from 08-02):**
    12. Open same session in two browser tabs
    13. Edit an item in one tab - should see brief flash in other tab

    **Test error handling (from 08-03):**
    14. Go to a non-existent session code (e.g., /session/XXXXXX)
    15. Should see friendly "Bill Not Found" message with link to start new
    16. Try joining a session with a name that's already taken
    17. Should see friendly error message about duplicate name
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 8, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] Join flow shows user-friendly error for duplicate name
- [ ] Session not found page provides helpful guidance
- [ ] All Phase 8 polish changes verified visually
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- User approved visual/functional verification
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-optimization/08-03-SUMMARY.md`
</output>
