---
phase: 07-summary-display
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/components/ReceiptImageViewer.tsx, src/pages/Session.tsx]
autonomous: false
---

<objective>
Add receipt image viewing capability to the Items tab.

Purpose: Let users see the original receipt image to verify OCR parsing or reference details.
Output: ReceiptImageViewer component with modal display, accessible via link-button in Items tab.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-summary-display/07-CONTEXT.md

@src/pages/Session.tsx
@convex/receipts.ts
@convex/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ReceiptImageViewer component</name>
  <files>src/components/ReceiptImageViewer.tsx</files>
  <action>
Create a modal component for viewing the original receipt image:

1. Props: `storageId: Id<"_storage">`, `onClose: () => void`
2. Use `useQuery(api.receipts.getReceiptUrl, { storageId })` to get image URL
3. Modal structure:
   - Full-screen dark overlay (bg-black/80)
   - Image centered with max-w-[90vw] max-h-[85vh] object-contain
   - Close button (X) in top-right corner, white on dark background
   - Tap outside image to close
4. Loading state: Show spinner while URL resolves
5. Handle missing image gracefully (null URL)
  </action>
  <verify>npm run build succeeds with no TypeScript errors</verify>
  <done>ReceiptImageViewer component created with modal display</done>
</task>

<task type="auto">
  <name>Task 2: Integrate receipt viewer into Session page</name>
  <files>src/pages/Session.tsx</files>
  <action>
Add receipt image viewing to the Items tab:

1. Import ReceiptImageViewer component
2. Add state: `const [showReceiptImage, setShowReceiptImage] = useState(false)`
3. In the Receipt section (Items tab), when `session.receiptImageId` exists:
   - Add a link-button: "View original receipt" (text-blue-500, underline, small font)
   - Place it after the "Receipt uploaded" message or near ReceiptCapture
   - onClick: `setShowReceiptImage(true)`
4. Render ReceiptImageViewer conditionally:
   ```tsx
   {showReceiptImage && session.receiptImageId && (
     <ReceiptImageViewer
       storageId={session.receiptImageId}
       onClose={() => setShowReceiptImage(false)}
     />
   )}
   ```
5. Position the viewer at root of component (portals to body or absolute in page)
  </action>
  <verify>npm run build succeeds with no TypeScript errors</verify>
  <done>Receipt viewer integrated into Session page, accessible from Items tab</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Receipt image viewing modal accessible from Items tab</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Create a session and upload a receipt image
    3. Verify: "View original receipt" link appears in Receipt section
    4. Click the link
    5. Verify: Modal opens with full receipt image displayed
    6. Verify: Image is properly sized (not cropped, scrollable if needed)
    7. Verify: X button closes modal
    8. Verify: Tapping dark overlay closes modal
    9. Mobile test: Resize to mobile width, verify image fits screen
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] Receipt image viewer modal displays correctly
- [ ] Modal closes via X button and backdrop click
- [ ] Mobile-responsive image sizing
</verification>

<success_criteria>

- All tasks completed
- Receipt image viewable from Items tab
- Modal provides good UX (centered, properly sized, easy to close)
- No errors or warnings introduced
</success_criteria>

<output>
After completion, create `.planning/phases/07-summary-display/07-01-SUMMARY.md`
</output>
